<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Creative - Bootstrap 3 Responsive Admin Template">
  <meta name="author" content="GeeksLabs">
  <meta name="keyword" content="Creative, Dashboard, Admin, Template, Theme, Bootstrap, Responsive, Retina, Minimal">
  <link rel="shortcut icon" href="img/favicon.png">
  <!-- Page level plugin CSS-->
  <link href="../js/datatables/dataTables.bootstrap4.css" rel="stylesheet">

  <title>Blank | Creative - Bootstrap 3 Responsive Admin Template</title>

  <!-- Bootstrap CSS -->
  <link href="../css/bootstrap.min.css" rel="stylesheet">
  <!-- bootstrap theme -->
  <link href="../css/bootstrap-theme.css" rel="stylesheet">
  <!--external css-->
  <!-- font icon -->
  <link href="../css/elegant-icons-style.css" rel="stylesheet" />
  <link href="../css/font-awesome.min.css" rel="stylesheet" />
  <!-- Custom styles -->
  <link href="../css/style.css" rel="stylesheet">
  <link href="../css/style-responsive.css" rel="stylesheet" />

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 -->
  <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
      <script src="js/respond.min.js"></script>
      <script src="js/lte-ie7.js"></script>
    <![endif]-->

    <!-- =======================================================
      Theme Name: NiceAdmin
      Theme URL: https://bootstrapmade.com/nice-admin-bootstrap-admin-html-template/
      Author: BootstrapMade
      Author URL: https://bootstrapmade.com
    ======================================================= -->
</head>

<body>
  <!-- container section start -->
  <section id="container" class="">
    <!--header start-->

    <header class="header dark-bg">
      <div class="toggle-nav">
        <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"><i class="icon_menu"></i></div>
      </div>

      <!--logo start-->
      <a href="index.html" class="logo">Sistema <span class="lite">Montessori</span></a>
      <!--logo end-->

      <div class="nav search-row" id="top_menu">
        <!--  search form start -->
        <ul class="nav top-menu">
          <li>
            <form class="navbar-form">
              <input class="form-control" placeholder="Search" type="text">
            </form>
          </li>
        </ul>
        <!--  search form end -->
      </div>

      <div class="top-nav notification-row">
        <!-- notificatoin dropdown start-->

      </div>
    </header>
    <!--header end-->

    <!--sidebar start-->
    <aside>
      <div id="sidebar" class="nav-collapse ">
        <!-- sidebar menu start-->
        <ul class="sidebar-menu">
          <li class="">
            <a class="" href="CursosAdministrador.html">
                          <i class="icon_pens"></i>
                          <span>Cursos</span>
                      </a>
          </li>
          <li class="sub-menu">
            <a href="TemasInteresAdministrador.html" class="">
                          <i class="icon_document_alt"></i>
                          <span>Temas de Interés</span>
                      </a>
          </li>
          <li class="sub-menu">
            <a href="AvisosAdministrador.html" class="">
                          <i class="icon_info_alt"></i>
                          <span>Avisos</span>
                      </a>
          </li>
          <li>
            <a class="" href="UsuariosAdministrador.html">
                          <i class="icon_profile"></i>
                          <span>Usuarios</span>
                      </a>
          </li>
          <li>
            <a class="" href="GruposAdministrador.html">
                          <i class="icon_group"></i>
                          <span>Grupos</span>
                      </a>
          </li>
          <li class="sub-menu">
            <a onclick="salir()" href="#" class="">
                          <i class="icon_close_alt2"></i>
                          <span>Salir</span>
                      </a>
          </li>
        </ul>
        <!-- sidebar menu end-->
      </div>
    </aside>
    <!--sidebar end-->

    <!--main content start-->
    <section id="main-content">
      <section class="wrapper">
        <div class="row">
          <div class="col-lg-12">
            <h3 class="page-header"><i class="fa fa fa-bars"></i> Contenido</h3>
            <ol class="breadcrumb">
              <li><i class="fa fa-home"></i><a href="CursosAdministrador.html">Cursos</a></li>
            </ol>
          </div>
        </div>
        <!-- page start-->
          <div>
            <button type="button" onclick="CrearCurso()" class="btn btn-success pull-right">Crear Curso</button>
          </div>
              <br>
              <br>

          <div class="row">
          <div class="col-lg-12">
            <section class="panel">
              <header class="panel-heading">
              </header>
              <div class="table-responsive">
                <table class="table" id="tabla_cursos">
                  <thead>
                    <tr>
                      <th>Número</th>
                      <th>Título</th>
                      <th>Objetivo</th>
                      <th>Descripción</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody id="cuerpo_tabla">
                  </tbody>
                </table>
              </div>

            </section>
          </div>
        </div>
        <!-- page end-->
          <!-- Modal -->
            <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">ATENCION</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body" align="center">
                    <h3>¿Esta seguro de querer eliminar este curso?</h3>
                    <input type="text" value="" style="display: none" id="input_valor"/>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="elimina()">Estoy Seguro</button>
                  </div>
                </div>
              </div>
            </div>
        <!-- modales -->
        <!-- page end-->
          <!-- Modal -->
          <div class="modal fade" id="modalError" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">ATENCION</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body" align="center">
                  <h3 id="mensajeError"></h3>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="redirige()">Aceptar</button>
                </div>
              </div>
            </div>
          </div>
        <!-- modales -->

      </section>
    </section>
    <!--main content end-->
    <div class="text-right">
      <div class="credits">
          <!--
            All the links in the footer should remain intact.
            You can delete the links only if you purchased the pro version.
            Licensing information: https://bootstrapmade.com/license/
            Purchase the pro version form: https://bootstrapmade.com/buy/?theme=NiceAdmin
          -->
        </div>
    </div>
  </section>
  <!-- container section end -->
  <!-- javascripts -->
  <script src="../js/jquery.js"></script>
  <script src="../js/bootstrap.min.js"></script>
  <!-- nice scroll -->
  <script src="../js/jquery.scrollTo.min.js"></script>
  <script src="../js/jquery.nicescroll.js" type="text/javascript"></script>
  <!--custome script for all page-->
  <script src="../js/scripts.js"></script>
  <script src="../js/gestion_cuenta.js"></script>
    <script src="../js/datatables/jquery.dataTables.js"></script>
    <script src="../js/datatables/dataTables.bootstrap4.js"></script>

</body>

</html>

<script>
    function CrearCurso(){
        location.href ="FormularioCrearCurso.html";
    }
    var usuario="";
    var categoria="";
    $( window ).load(function() {
        //alert("epale");
        obtenerUsuario();
        obtenerCursos();
    });

    function obtenerUsuario(){
        var exito = false;
				//alert(usr);
                var dataForm = new FormData();
			  dataForm.append('user','user');
			  var pagina = "../controller/obtener_usuario.php";
			  $.ajax({
			    contentType: false,
			    processData: false,
			      // la URL para la petición
			      url : pagina,
			      // la información a enviar
			      // (también es posible utilizar una cadena de datos)
			      data : dataForm,
			      // especifica si será una petición POST o GET
			      type : 'POST',
			      // el tipo de información que se espera de respuesta
			      dataType : 'json',
			      // código a ejecutar si la petición es satisfactoria;
			      // la respuesta es pasada como argumento a la función
			      success : function(json) {
			        //console.log(json);
			        if(json['exito']==true){
                        if(json['categoria'].localeCompare("3")!=0){
                            alert("No se ha iniciado ninguna sesión");
				            location.href ="../index.html";
                        }else{
                            //console.log(json['usuario']);
                            //console.log(json['categoria']+":"+typeof(json['categoria']));
                            usuario=json['usuario'];
                            categoria=json['categoria'];
                        }
				        //alert("Registro exitoso");
			        }else{
                            //alert("No se ha iniciado ninguna sesión");
				            location.href ="../index.html";
								//alert(json['error']);
			          //document.getElementById('texto_tabla').innerHTML = json['error'];
			        }
			      },
			      error : function(xhr, status) {
							alert("Existió un error en el servidor...");
				            //location.href ="../index.html";
			      },
			      // código a ejecutar sin importar si la petición falló o no
			      complete : function(xhr, status) {
			          //alert('Petición realizada');
			      }
			  });//*/
                return (exito?true:false);
			}
    function obtenerCursos(){
        var dataForm = new FormData();
        dataForm.append("usuario",usuario);
        var pagina = "../controller/trae_cursos.php";
        $.ajax({
			    contentType: false,
			    processData: false,
			      // la URL para la petición
			      url : pagina,
			      // la información a enviar
			      // (también es posible utilizar una cadena de datos)
			      data : dataForm,
			      // especifica si será una petición POST o GET
			      type : 'POST',
			      // el tipo de información que se espera de respuesta
			      dataType : 'json',
			      // código a ejecutar si la petición es satisfactoria;
			      // la respuesta es pasada como argumento a la función
			      success : function(json) {
                      //console.log(json);
                      for(var i=0;i<json["total"];i++){//recorremos los tramites
                          $("#tabla_cursos").append(
                              "<tr id=curso-'"+json['cursos'][i]['id_curso']+"'>"+
                              "<td>"+json["cursos"][i]["id_curso"]+
                              "</td><td>"+json["cursos"][i]["titulo"]+
                              "</td><td>"+json["cursos"][i]["objetivo"]+
                              "</td><td>"+json["cursos"][i]["descripcion"].substr(0,40)+
                              "</td><td>"+'<a href="http://localhost/montessori/view/FormularioEditarCurso.html?curso='+json["cursos"][i]["id_curso"]+'">Editar</a>'+
                              ' '+'<a href="#exampleModal" onclick="eliminarCurso('+json['cursos'][i]['id_curso']+')">Eliminar</a>'+
                              "</td>"+
                              "</tr>"
                          );
                      }
                      $("#tabla_cursos").DataTable(
                          {
                            searching:false,
              							lengthChange: false,
              							info:false,
              							pageLength: 10,
              							language:
              								{
              									emptyTable	:	"No hay datos para mostrar en la tabla",
              									zeroRecords	:	"No hay datos para mostrar en la tabla",
              									paginate:
              									{
              										"first":      "Primero",
              										"last":       "Ultimo",
              										"next":       "Siguiente",
              										"previous":   "Anterior"
              									}
              								}
				            });//*/
			      },
			      error : function(xhr, status) {
							alert("Existió un error en el servidor...");
			      },
			      // código a ejecutar sin importar si la petición falló o no
			      complete : function(xhr, status) {
			          //alert('Petición realizada');
			      }
			  });//*/
    }

    function eliminarCurso(id){
        //alert(id);
        $("#input_valor").val(id);
        $("#exampleModal").modal();
    }
    function redirige(){
      location.reload(true);;
    }
    function elimina(){
        var id = $("#input_valor").val();
        var dataForm = new FormData();
        dataForm.append("id_curso",id);
        var pagina = "../controller/eliminar_curso.php";
        $.ajax({
			    contentType: false,
			    processData: false,
			      // la URL para la petición
			      url : pagina,
			      // la información a enviar
			      // (también es posible utilizar una cadena de datos)
			      data : dataForm,
			      // especifica si será una petición POST o GET
			      type : 'POST',
			      // el tipo de información que se espera de respuesta
			      dataType : 'json',
			      // código a ejecutar si la petición es satisfactoria;
			      // la respuesta es pasada como argumento a la función
			      success : function(json) {
                      //console.log(json);
                      //location.reload(true);
                      $("#mensajeError").text("El cuso se ha eliminado correctamente");
                      $("#modalError").modal('show');//Modal de mensaje de errors
			      },
			      error : function(xhr, status) {
							//alert("Existió un error en el servidor...");
              $("#mensajeError").text("Existió un error en el servidor...");
              $("#modalError").modal('show');//Modal de mensaje de errors
			      },
			      // código a ejecutar sin importar si la petición falló o no
			      complete : function(xhr, status) {
			          //alert('Petición realizada');
			      }
			  });//*/
    }

</script>
